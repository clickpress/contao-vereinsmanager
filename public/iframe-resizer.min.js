/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/@open-iframe-resizer/core@1.6.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const p=()=>typeof window<"u",E=()=>window.self!==window.top,b=e=>e instanceof HTMLIFrameElement,M=e=>{"complete"===window.document.readyState?e():window.addEventListener("load",e)},T=(e,t)=>{t(),e.addEventListener("load",t)},C=(e,t)=>{var n,r;const i="complete"===(null==(n=e.contentWindow)?void 0:n.document.readyState);return"about:blank"!==e.src&&"about:blank"!==(null==(r=e.contentWindow)?void 0:r.location.href)&&i?t():e.addEventListener("load",t)},B=()=>({offsetSize:0,checkOrigin:!0,enableLegacyLibSupport:!1}),k=e=>{try{return new URL(e.src).origin===window.location.origin}catch{return!1}},D=e=>{try{const t=new URL(e.src).origin;if("about:blank"!==t)return t}catch{}return null},W=e=>(Object.keys(e).forEach((t=>void 0===e[t]&&delete e[t])),e),L=e=>{const{height:t,width:n}=e.getBoundingClientRect();return{height:Math.ceil(t),width:Math.ceil(n)}},g=(e,t)=>e?t?e.querySelector(t):e.documentElement:null,I=(e,t)=>{e&&(t.bodyPadding&&(e.body.style.padding=t.bodyPadding),t.bodyMargin&&(e.body.style.margin=t.bodyMargin))},h=e=>e<=100?100:e<=120?1e3:1e4,A=()=>"[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false";function H(e){if("string"!=typeof e.data||!e.data.startsWith("[iFrameSizer]")||!e.data.endsWith("mutationObserver")&&!e.data.endsWith("resizeObserver"))return null;const[t,n]=e.data.split(":"),r=+n;return r>0?r:null}const z=q();let f=[];const K=(e,t)=>{if(!p())return[];const n={...B(),...W(e??{})},r=P(t),i=x(n,r);return r.map((e=>{const t={iframe:e,settings:n,interactionState:{isHovered:!1},initContext:{isInitialized:!1,retryAttempts:0}},r=F(t,i);return f.push(t),{unsubscribe:()=>{r(),f=f.filter((t=>t.iframe!==e))}}}))};function P(e){return"string"==typeof e?Array.from(document.querySelectorAll(e)).filter(b):e?b(e)?[e]:[]:Array.from(document.getElementsByTagName("iframe"))}function x(e,t){if(Array.isArray(e.checkOrigin))return e.checkOrigin;if(!e.checkOrigin)return[];const n=[];for(const e of t){const t=D(e);t&&n.push(t)}return n}function F(e,t){const n=k(e.iframe)?U(e):N(e,t),r=$(e);return()=>{n(),r()}}function N(e,t){const{iframe:n,initContext:r,settings:{checkOrigin:i,enableLegacyLibSupport:o,targetElementSelector:a,bodyPadding:s,bodyMargin:c}}=e,d=r=>{var a;const s=!i||t.includes(r.origin);if(n.contentWindow===r.source&&s){if("iframe-resized"===(null==(a=r.data)?void 0:a.type)){const{height:t}=r.data;return void(t&&m({newHeight:t,registeredElement:e}))}if(o){const t=H(r);return void(null!==t&&m({newHeight:t,registeredElement:e}))}}};window.addEventListener("message",d);const u=o?A():{type:"iframe-child-init",targetElementSelector:a,bodyPadding:s,bodyMargin:c},l=()=>{T(n,(()=>{var e;return null==(e=n.contentWindow)?void 0:e.postMessage(u,"*")})),r.retryAttempts++,r.retryTimeoutId=window.setTimeout(l,h(r.retryAttempts))};return l(),()=>window.removeEventListener("message",d)}function U(e){const{iframe:t,settings:n}=e,{targetElementSelector:r}=n;let i=0;const o=()=>{const e=g(t.contentDocument,r);if(!t.contentDocument||!e)return i++,setTimeout(o,h(i));I(t.contentDocument,n),z().observe(e)};return C(t,o),()=>{const e=g(t.contentDocument,r);e&&z().unobserve(e),t.removeEventListener("load",o)}}function $({iframe:e,interactionState:t}){const n=()=>{t.isHovered=!0},r=()=>{t.isHovered=!1};return e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",r),()=>{e.removeEventListener("mouseenter",n),e.removeEventListener("mouseleave",r)}}function q(){let e=null;return()=>{if(!e){const t=({target:e})=>{const t=f.find((({iframe:t})=>t.contentDocument===e.ownerDocument));if(!t)return;const{iframe:n,settings:r}=t,i=g(n.contentDocument,r.targetElementSelector);if(!i)return;const{height:o}=L(i);o&&m({newHeight:o,registeredElement:t})};e=new ResizeObserver((e=>e.forEach(t)))}return e}}function m({registeredElement:e,newHeight:t}){var n;const{iframe:r,settings:i,interactionState:o,initContext:a}=e;if(a.isInitialized||(a.isInitialized=!0,clearTimeout(a.retryTimeoutId)),!1===(null==(n=i.onBeforeIframeResize)?void 0:n.call(i,{iframe:r,settings:{...i},observedHeight:t})))return;const s=r.getBoundingClientRect(),c=t+i.offsetSize;if(r.style.height=`${c}px`,!i.onIframeResize)return;const d={iframe:r,settings:{...i},interactionState:{...o},previousRenderState:{rect:s},nextRenderState:{rect:r.getBoundingClientRect()}};i.onIframeResize(d)}const V=G();let v=!1;function _(){!p()||!E()||window.addEventListener("message",(e=>{var t;"iframe-child-init"===(null==(t=e.data)?void 0:t.type)&&M((()=>O(e)))}))}function O(e,t=0){const{targetElementSelector:n,bodyPadding:r,bodyMargin:i}=e.data,o=g(document,n);if(v||window.parent!==e.source)return;if(!o)return setTimeout((()=>O(e,t+1)),h(t));I(document,{bodyMargin:i,bodyPadding:r});const a=V();a.disconnect(),a.observe(o),v=!0}function G(){let e=null;return()=>(e||(e=new ResizeObserver((e=>{if(!e[0].target)return;const{height:t,width:n}=L(e[0].target),r={type:"iframe-resized",width:n,height:t};window.parent.postMessage(r,"*")}))),e)}_();const Q=({previousRenderState:e,nextRenderState:t,iframe:n})=>{document.activeElement===n&&window.scrollBy(0,t.rect.bottom-e.rect.bottom)};export{K as initialize,_ as initializeChildListener,Q as updateParentScrollOnResize};
//# sourceMappingURL=/sm/3869ad3d8e8cdb23571aa77d7e55d32a6d1b14d053ad87f08eca8ae644a535a7.map